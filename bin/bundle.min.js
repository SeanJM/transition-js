function forEach(a,b){for(var c in a)if(b(a[c],c)===!1)return!1}function mix(a,b,c){return a+(b-a)*c}function round(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)}function then(a){a.method.catch=[],whileType(a.method.then)}function whileType(a){for(var b=arguments.length,c=new Array(b),d=1;d<b;d++)c.push(arguments[d]);for(;a&&a.length;)a[0].apply(c),a.shift()}function Animate(a,b){this.method={then:[],catch:[]},this.options=a.options,this.callback=b,this.iterations=0}function deltaBack(a){var b=6;return Math.pow(a,2)*((b+1)*a-b)}function deltaBounce(a){for(var b=0,c=1;1;b+=c,c/=2)if(a>=(7-4*b)/11)return-Math.pow((11-6*b-11*a)/4,2)+Math.pow(c,2)}function deltaLinear(a){return a}function deltaQuadratic(a){return Math.pow(a,6)}function easeInOut(a,b){return b<=.5?a(2*b)/2:(2-a(2*(1-b)))/2}function easeIn(a,b){return a(b)}function easeOut(a,b){return 1-a(1-b)}function method_start(a){return new Animate(this,a).start()}function method_transition(a){var b={},c={},d={back:deltaBack,bounce:deltaBounce,linear:deltaLinear,quadratic:deltaQuadratic},e={in:easeIn,"in-out":easeInOut,out:easeOut};for(var f in a)DEFAULT_PROPS.indexOf(f)===-1&&(b[f]=a[f][0],c[f]=a[f][1]);this.options={start:b,end:c,delta:d[a.delta]||d.quadratic,ease:e[a.ease]||e["in-out"],elastic:a.elastic||0,iterations:"number"==typeof a.iterations?a.iterations:1,duration:a.duration||300,delay:a.delay||0,fps:a.fps?1e3/a.fps:10}}function method_then(a){"function"==typeof a&&a()}function Transition(a){this.queue=[],this.history=[],enqueue(this,{name:"transition",method:method_transition,arguments:[a]})}var DEFAULT_PROPS=["delta","ease","elastic","iterations","duration","delay","fps"];Animate.prototype.then=function(a){this.method.then.push(a)},Animate.prototype.elastify=function(a,b){var c=1-Math.pow(b,6),d=1-Math.pow(2,15*--c)*Math.cos(50*c*Math.PI*1/2);return mix(a,d,this.options.elastic)},Animate.prototype.start=function(){var a,b,c=this,d=this.options.start,e=this.options.end,f=this.options.duration,g=this.options.delay,h={};return setTimeout(function(){c.options.timer=setInterval(function(){b=b||new Date,a=Math.min((new Date-b)/f,1),forEach(d,function(b,f){var g=c.elastify(c.options.ease(c.options.delta,a),a),i=round(g,2);h[f]=d[f]+i*(e[f]-d[f])}),c.callback(h,a),1===a&&(c.iterations++,clearInterval(c.options.timer),c.options.iterations===c.iterations?then(c):c.start())},c.options.fps)},g),this},function(){function a(a){var b=a.slice(-1)[0],c=a.length>1&&a.slice(-2)[0],d=b&&c&&b.method!==method_then&&b.method===c.method;if(d)throw"Cannot chain two of the same method, unless that method is 'then'"}function b(a){var c,d=a.queue;!a.waiting&&d[0]&&(c=d[0].method.apply(a,d[0].arguments),c&&"function"==typeof c.then?(a.waiting=!0,c.then(function(){a.waiting=!1,d.shift(),b(a)})):(d.shift(),b(a)))}function c(c,d){c.queue.push(d),c.history.push(d),a(c.history),b(c)}window.enqueue=c}(),window.transition=function(a){return new Transition(a)},Transition.prototype.start=function(a){return enqueue(this,{name:"start",method:method_start,arguments:[a]}),this},Transition.prototype.transition=function(a){return enqueue(this,{name:"transition",method:method_transition,arguments:[a]}),this},Transition.prototype.then=function(a){return enqueue(this,{name:"then",method:method_then,arguments:[a]}),this},Transition.prototype.stop=function(a){return this.queue=[],clearInterval(this.options.timer),this},Transition.ease={in:easeIn,out:easeOut,inOut:easeInOut},Transition.delta={linear:deltaLinear,quadratic:deltaQuadratic,bounce:deltaBounce,back:deltaBack};